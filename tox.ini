[tox]
env_list =
    py{311,312,313}-test{,-devdeps,-numpy1x}{,-cov}

[testenv]
description =
    run tests
    devdeps: with the latest developer version of key dependencies
    cov: and test coverage
    xdist: using parallel processing
pass_env =
    HOME
    WINDIR
    CC
    CI
set_env =
    devdeps: PIP_EXTRA_INDEX_URL = https://pypi.anaconda.org/astropy/simple https://pypi.anaconda.org/scientific-python-nightly-wheels/simple
# Run the tests in a temporary directory to make sure that we don't import package from the source tree
changedir = .tmp/{envname}
extras =
    test
deps =
    devdeps: astropy>=0.0.dev0
    cov: pytest-cov
    numpy1x: numpy==1.*
    xdist: pytest-xdist
commands_pre =
    pip list
commands =
    pytest \
    --pyargs spherical_geometry \
    cov: --cov --cov-config {toxinidir}/pyproject.toml --cov-report term-missing --cov-report xml \
    xdist: -n 0 \
    {posargs}
